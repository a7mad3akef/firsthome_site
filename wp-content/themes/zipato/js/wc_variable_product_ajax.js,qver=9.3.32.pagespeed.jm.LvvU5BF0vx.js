function setCartScroll(){var container=jQuery('.cart-list-menu .festi-cart-widget-products-content');var winHeight=jQuery(window).height()*0.75;if(container.height()>winHeight){container.css('max-height',Math.ceil(winHeight)+'px');}if(typeof container.mCustomScrollbar==="function"){container.mCustomScrollbar({theme:"dark",axis:'y'});}}function table_size(){var table=jQuery('table.shop_table.cart');if(table){var count_td=table.find('tbody>tr.cart_item');if(count_td.length>=6){table.parents('.widget_festiwoocartprowidget').first().removeClass('big_tr').addClass('small_tr');}else{table.parents('.widget_festiwoocartprowidget').first().removeClass('small_tr').addClass('big_tr');}}}jQuery(document).ready(function(){var $=jQuery;setTimeout(function(){table_size();},450);function fragments_update(x_element,data){try{$supports_html5_storage=('sessionStorage'in window&&window.sessionStorage!==null);window.sessionStorage.setItem('wc','test');window.sessionStorage.removeItem('wc');}catch(err){$supports_html5_storage=false;}if(data&&data.fragments){$.each(data.fragments,function(key,value){$(key).replaceWith(value);});}table_size();setCartScroll();loading_gif('stop');jQuery('a[data-add-to-cart="'+x_element+'"]').removeClass('loading');return false;}function loading_gif(stage,txt){if(stage=='start'){$('#lock_screen').find('.spinner-head-text').html(txt);$('#header_cart').find('span').addClass('loading_gif');$('#lock_screen').fadeIn(300).show();}else{$('#lock_screen').fadeOut(100);$('#lock_screen').find('.spinner-head-text').html('');$('#header_cart').find('span').removeClass('loading_gif');}}jQuery(document).on('click','.button_js.remove',function(e){e.preventDefault();var href=jQuery(this).attr('href');if(href){loading_gif('start','Removing product');var remove_item=href.split('remove_item=')[1].split('&')[0];var serObject={};var form=jQuery(this).parents('form');if(!form.parents('.widget_festiwoocartprowidget').first().children('div').first().hasClass('festi-cart-widget-products-content')){serObject.forse_cart=true;}$.ajax({type:'POST',url:'/ajax/?remove_item='+remove_item,dataType:'json',data:serObject,success:function(data,textStatus,jqXHR){fragments_update('',data);}});return false;}});jQuery(document).on('click','.add_to_cart_button:not(.productOut)',function(e){e.preventDefault();var url='';var data='';var btnClicked=jQuery(this);btnClicked.addClass('loading');loading_gif('start','Adding product to cart');if(btnClicked.hasClass('recipe_add')){var pdObject={};var table=jQuery(this).closest('form.cart-recipe').children('table.recipe-group-table');table.find('tr').each(function(){pdObject[jQuery(this).attr('data-productId')]=jQuery(this).find('td .quantity input.qty').val();});url='/ajax/?add-grouped='+btnClicked.data().product_id;data='includedProduct='+JSON.stringify(pdObject);}else{url='/ajax/?add-to-cart='+btnClicked.data().product_id;data=$.param(btnClicked.data());}$.ajax({type:'POST',url:url,data:data,dataType:'json',success:function(data,textStatus,jqXHR){if(data.alert)alert(data.alert);if(data.console)console.log(data.console);fragments_update(btnClicked.attr('data-add-to-cart'),data);},});setTimeout(function(){btnClicked.removeClass('loading');},10000);return false;});$(document).on('keyup click','.plus, .minus, .qty',function(e){var elem=jQuery(this);var even=e.type;if((jQuery(this).hasClass('qty')&&e.type=='keyup')||(!jQuery(this).hasClass('qty')&&e.type=='click')){var form=jQuery(this).parents('form');if(!form.hasClass('cart-recipe')){var cartQty='';if(jQuery(this).hasClass('qty')){cartQty=jQuery(this);}else{cartQty=jQuery(this).parent().find('input[name^=cart]');}var matches=cartQty.attr('name').match(/cart\[(\w+)\]/);if(matches!=null){cart_item_key=matches[1];var added=jQuery(this).hasClass('plus')?1:jQuery(this).hasClass('minus')?-1:0;var serObject={'cartKeySanitized':cart_item_key,'cartQtySanitized':(parseFloat(cartQty.val())+added)};if(!form.parents('.widget_festiwoocartprowidget').first().children('div').first().hasClass('festi-cart-widget-products-content')){serObject.forse_cart=true;}$.ajax({type:'POST',url:'/ajax/',data:serObject,dataType:'json',success:function(data,textStatus,jqXHR){if(data.alert)alert(data.alert);if(data.console)console.log(data.console);fragments_update('',data);if(elem.hasClass('qty')&&even=='keyup'){var input1=jQuery('input[name="'+cartQty.attr('name')+'"]');var originalValue=input1.val();input1.val('');input1.blur().focus().val(originalValue);}}});return false;}}}});});jQuery(window).load(function(){window.loaded=true;setCartScroll();});jQuery(window).resize(function(){setCartScroll();});